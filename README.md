I needed to solve this programmatically so that I won't waste more time to this silly puzzle.
